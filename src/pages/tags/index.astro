---
import Layout from "../../layouts/Layout.astro";
import getPublishedPosts from "../../utils/getPublishedPosts";
import getUniqueTags from "../../utils/getUniqueTags";

const posts = await getPublishedPosts();
const tags = getUniqueTags(posts);

const postPerTag = tags.map((tag) => ({
  tag: tag,
  posts: posts.reduce((acc, item) => {
    if (item.frontmatter.tags.includes(tag)) {
      return (acc = acc + 1);
    } else {
      return acc;
    }
  }, 0),
}));
---

<Layout title="Tags">
  <div class="mt-4 rounded-lg bg-gray-800 p-5 text-xl font-bold text-gray-200">
    Tags
  </div>
  <div
    class="mt-4 flex flex-col gap-3 rounded-lg bg-gray-800 p-5 text-gray-300"
  >
    {
      postPerTag.map((tag) => (
        <a href={`/tags/${tag.tag}`}>
          <div class="flex justify-between">
            {tag.tag}
            <p class="text-gray-400">[ {tag.posts} ]</p>
          </div>
        </a>
      ))
    }
  </div>
</Layout>
